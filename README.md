# scopus_app

Dissertation project

## Description

Application, in which the user can search documents in Scopus database using a query (chooses its settings in UI).

Analyzes documents from query, and returns the results.

When analyzing is finished, an Excel file may be exported (if user chooses to), containing all the dictionaries mentioned above (documents with its info). Moreover, results can be saved in local database of the client's application. Statistics are extracted, too.

### Works for

Journal Sources

## Prerequisites

1. Python 3.7
2. Correct version chromedriver (depends on your version of Chrome, for more see http://chromedriver.chromium.org/)
3. If using Windows, please add Chromedriver in PATH (for more see https://www.computerhope.com/issues/ch000549.htm)

## Requirements

```
pip install -r requirements.txt
```

### NOTE!

I haven't tested in other browser drivers, rather than Chrome

## System Architecture

### Client-Side Application (ScopusAnalyzer)

The Client-Side application, called ScopusAnalyzer, is a desktop application written in the Python programming language with the help of the PyQt library (version 5). With this application, the customer has the ability to perform the following functions (briefly):

1. Perform a configured search in the Scopus bibliographic database,

2. Extract various descriptive statistics from existing Excel files, which have been generated by the application itself,

3. To extract statistics from data that are internally located in the local customer database,

4. Enter data from Excel files into the client database (files must be extracted from the application itself)

### Server

The system's server has been implemented, as has the application of the client with the use of Python programming language. The library used to support the server, as well as the customer-server communication process, is Python-SocketIO.
In essence, the Server has the following responsibilities:

1. Receive requests from the customer and transfer them to Selenium WebDriver (ChromeDriver),

2. Manage Selenium WebDriver, giving it appropriate commands each time,

3. Informing the customer about the progress of his request (sends how many documents have been checked so far)

4. Receive the results through Selenium WebDriver and send them (as a list) to the customer

### Selenium WebDriver

Basically, WebDriver is the latest and deepest component of the system. WebDriver (in the case of the system, ChromeDriver) is essentially responsible for executing the server's commands. Having the status of agent, but also the necessary data, parsing web pages, drawing from it all the necessary information.

WebDriver is a separate process that runs on the server's operating system. The information that he keeps is the same as the information that a common browser holds (cache, cookies, etc.). The life cycle of this process depends directly on the service life of the server. As long as the server is running, WebDriver will run as well. When the server shuts down, any information held by WebDriver is lost along with that of the server.


![alt_text](https://i.imgur.com/8WWoGAe.png "System's Architecture Diagram")

## More information on ScopusAnalyzer (Client's Application)

### Procedures

#### Execute Parametered Search in the Scopus' bibliographic database

i. It selects the parameters offered by the graphical interface, as well as the Excel file export folder or the Excel name itself (if it wishes to be exported to an external file). It also selects whether it wants the results to be stored in the local database of the program. As soon as the user presses the "Proceed" button, the query string is created and sends the request to the server.

ii. Once the request is received by the server, it is sent to WebDriver to perform the search. Once the search is done and the results are displayed in Scopus' Document Page, WebDriver notifies the server and receives a new request from him, so that he can start visiting the sources successively and return the metric values, the name, etc. As soon as it is checked and last magazine, the analysis stops.

iii. When WebDriver stops analyzing, the application server processes them, and places them in the appropriate structure so that they can send them back to the client application.

iv. Once the analysis is complete, a notification window appears that the search has been completed and is given the option to view the search results structured through the Results form.
In case the user chooses to see the search results, the Results form is displayed.
The user has the option to go back to the Menu form or proceed to see the statistics. If he chooses to see the statistical charts, the program produces them with the help of the matplotlib library and displays them in a separate window, from which the user has the ability to save the image.

![alt_text](https://i.imgur.com/YsZqnlL.png "Search Operation")

#### Extracting Statistics from Existing Excel Files

If the user chooses to export statistics from multiple Excel files, he will select the Import Excels tab, and add or drag the files he already owns, so that the program can produce statistical charts based on these files. The user selects the "Export" button and then a new window will appear, which will allow the user to adjust the export details (eg the range of years they wish to be examined), what kind of statistics will be exported. (whether the aggregate database data, diagrams, percentile per department, percentiles per professor), the name of the export file, and the export directory will be extracted. These diagrams will show over time the course of the reports of the professors of the University of Macedonia. Diagrams related to the course of the various indicators (on average) also appear. If the user has only added one file, then, obviously, the diagrams concerning the time course of the various indicators will not appear.

![alt_text](https://i.imgur.com/ltHpj37.png "Extract Statistics from Excel Files")

![alt_text](https://i.imgur.com/tyHV7xu.png "Extract Statistics from Excel Files 2")

#### Extracting Statistics from the Client's Application Database

If the user chooses to extract statistics from the already existing database data, he will select the Database tab, and will select the "Export Statistics" button. A new window will then appear, which will allow the user to adjust the export details (eg the range of years they wish to be examined), what kind of statistics will be exported (if the aggregate database data will be exported). data, diagrams, percentile per department, percentiles per professor), the name of the export file, and the export directory. These diagrams will show over time the course of the reports of the professors of the University of Macedonia.

![alt_text](https://i.imgur.com/fi67rHY.png "Extract Statistics from Local DB")

![alt_text](https://i.imgur.com/tyHV7xu.png "Extract Statistics from Local DB 2")

#### Enter data in the Database from External Files

If the user chooses to import data from external Excel files into the application database, he will select the Database tab and select the "Insert from Excel" button. Then a new window will appear, which will allow the user to add or drag the files he already owns, so that the program can import them into its local database.

**Note:** In the case of duplicates, the program will keep what already exists in the database.

![alt_text](https://i.imgur.com/AkwmKpK.png "Insert to Database")

#### Deletion of data from the Database

If the user wants to delete data from the database, he will select the Database tab and select the "Delete" button. A window will then appear, which will allow the user to select a year. By clicking "Ok", all documents will be deleted, along with the sources of that year.
If no data is generally available in the application database, the window will not appear. Instead, the user will be notified that the database is empty.

**Note:** Only deletion per year is allowed, so that there are no possible inconsistencies in the export of statistics (from a wrong deletion).

![alt_text](https://i.imgur.com/nw4m7EW.png "Delete data from Database (by Year)")

### Examples of Statistics

![alt_text](https://i.imgur.com/NLAK4cO.png "Stat1")


![alt_text](https://i.imgur.com/PfcYiY3.png "Stat2")


![alt_text](https://i.imgur.com/I0QiKk0.png "Stat3")

## Usage

### Client

```
python main.py
```

### Server

```
python server.py
```
